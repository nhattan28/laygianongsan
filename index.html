<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GiÃ¡ NÃ´ng Sáº£n</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<style>
  body {
    font-family: 'Quicksand', sans-serif;
    background: linear-gradient(135deg, #e6f3e6, #f0f7fa);
    color: #2d3748;
    margin: 0;
    overflow-x: hidden; /* NgÄƒn cuá»™n ngang trÃªn mobile */
  }
  #three-canvas {
    position: fixed;
    top: 0;
    left: 0;
    z-index: -1;
    opacity: 0.2;
    width: 100vw;
    height: 100vh;
  }
  .card {
    backdrop-filter: blur(10px);
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
    margin: 5px; /* ThÃªm margin cho card trÃªn mobile */
  }
  .card:hover {
    transform: translateY(-2px) scale(1.02);
  }
  table {
    width: 100%;
    margin: auto;
    border-collapse: collapse;
    font-size: 1.1 rem;
  }
  th, td {
    border: 1px solid #e2e8f0;
    padding: 6px;
    text-align: center;
    word-break: break-word; /* Cho phÃ©p ngáº¯t chá»¯ trÃªn mobile */
  }
  th {
    background: #edf2f7;
    font-weight: 600;
  }
  .positive {
    color: #38a169;
    font-weight: bold;
  }
  .negative {
    color: #e53e3e;
    font-weight: bold;
  }
  .nav-link {
    transition: background-color 0.3s ease, transform 0.3s ease;
    background: #edf2f7;
    padding: 6px 14px;
    border-radius: 6px;
    margin: 0 4px;
    font-size: 1rem; /* Cá»¡ chá»¯ lá»›n hÆ¡n cho nav-link */
    display: inline-block; /* Äáº£m báº£o bá»‘ cá»¥c tá»‘t trÃªn mobile */
  }
  .nav-link:hover {
    background: #2b6cb0;
    color: white;
    transform: scale(1.05);
  }
  /* TÄƒng cá»¡ chá»¯ cho ngayDacBiet vÃ  tenNgayLe */
  #ngayDacBiet, #tenNgayLe {
    font-size: 1rem;
    color: #2d3748;
    display: block;
    padding: 2px 0;
  }
  @media (max-width: 640px) {
    body {
      overflow-x: hidden; /* Äáº£m báº£o khÃ´ng cuá»™n ngang */
    }
    #three-canvas {
      width: 100%;
      height: auto;
    }
    .card {
      margin: 2px; /* Giáº£m margin trÃªn mobile */
    }
    table {
      font-size: 0.9rem; /* Giáº£m cá»¡ chá»¯ nhÆ°ng váº«n dá»… Ä‘á»c */
      width: 95%; /* TÄƒng width Ä‘á»ƒ láº¥p Ä‘áº§y mÃ n hÃ¬nh */
    }
    th, td {
      padding: 4px; /* Giáº£m padding trÃªn mobile */
      font-size: 0.9rem; /* Äá»“ng bá»™ cá»¡ chá»¯ vá»›i table */
    }
    .nav-link {
      padding: 4px 8px;
      font-size: 0.8rem; /* Giáº£m cá»¡ chá»¯ nav-link trÃªn mobile */
      margin: 0 2px;
      white-space: nowrap; /* NgÄƒn ngáº¯t dÃ²ng cho nav-link */
    }
    #ngayDacBiet, #tenNgayLe {
      font-size: 0.85rem; /* Giáº£m cá»¡ chá»¯ trÃªn mobile nhÆ°ng váº«n rÃµ */
      padding: 1px 0;
    }
    h3 {
      font-size: 0.9rem; /* Giáº£m cá»¡ chá»¯ tiÃªu Ä‘á» trÃªn mobile */
    }
  }
</style>
</head>
<body class="min-h-screen flex items-center justify-center p-2">
  <canvas id="three-canvas"></canvas>
<div class="w-full max-w-[95vw] md:max-w-4xl mx-auto h-auto grid grid-rows-[auto,1fr,1fr] gap-3 py-3">
    <!-- Navigation Buttons -->
    <div class="flex flex-wrap justify-center gap-2">
      <a href="xangdau.html" class="nav-link text-sm font-semibold text-gray-700">â›½ XÄƒng dáº§u</a>
      <a href="ngayle.html" class="nav-link text-sm font-semibold text-gray-700">ğŸ‰ NgÃ y lá»…</a>
    </div>

    <!-- Lá»‹ch Ã¢m dÆ°Æ¡ng -->
    <div class="card p-3">
      <h3 class="text-lg md:text-xl font-semibold text-center text-gray-800 mb-2">ğŸŒ¾ GiÃ¡ NÃ´ng Sáº£n ğŸŒ¾</h3>
      <table class="time-table">
        <tr>
          <td colspan="3" class="py-1">
            <span id="clock" class="text-base md:text-lg font-bold text-gray-700">--:--:--</span>
          </td>
        </tr>
        <tr>
          <th>Thá»©</th>
          <th>DÆ°Æ¡ng lá»‹ch</th>
          <th>Ã‚m Lá»‹ch</th>
        </tr>
        <tr>
          <td><span id="thu">Äang táº£i...</span></td>
          <td><span id="ngayDuong">Äang táº£i...</span></td>
          <td><span id="ngayAmLich">Äang táº£i...</span></td>
        </tr>
        <tr>
          <td colspan="3">
            <span id="ngayDacBiet" class="text-xs text-gray-600"></span>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <span id="tenNgayLe" class="text-xs text-gray-600">KhÃ´ng cÃ³ ngÃ y lá»…</span>
          </td>
        </tr>
      </table>
    </div>

    <!-- Merged GiÃ¡ CÃ  PhÃª and GiÃ¡ TiÃªu with single line layout -->
<div class="card p-3">
  <div id="ngayTongHop" style="text-align: center; font-size: 20px; font-weight: bold;">
    Äang táº£i ngÃ y cáº­p nháº­t...
  </div>
  <div id="giaNongSan" class="text-xs md:text-sm mt-2">Äang táº£i giÃ¡ nÃ´ng sáº£n...</div>
</div>


  <script>
    // Three.js for 3D background
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-canvas'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    
    const geometry = new THREE.SphereGeometry(5, 32, 32);
    const material = new THREE.MeshBasicMaterial({ color: 0x38a169, wireframe: true });
    const sphere = new THREE.Mesh(geometry, material);

    camera.position.z = 10;
    
    function animate() {
      requestAnimationFrame(animate);
      sphere.rotation.y += 0.005;
      renderer.render(scene, camera);
    }
    animate();
    
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Modified JavaScript to merge price tables with single line headers
async function loadGia() {
  try {
    const response = await fetch('https://script.google.com/macros/s/AKfycbzQ1loBs5fd9I4Pwo1IN-2u26nGSBSefkJFibPxzKVBktoTH9pM2MeCcK0F-0Lfebe_/exec');
    const data = await response.json();

    // ğŸ‘‰ Láº¥y ngÃ y cáº­p nháº­t riÃªng cho cÃ  phÃª vÃ  tiÃªu
    const ngayCapNhatCaPhe = data.caphe?.ngay || 'khÃ´ng rÃµ';
    const tieuDe = data.tieu?.tieuDe || '';
    const match = tieuDe.match(/(\d{2}\/\d{2}\/\d{4})/);
    const ngayCapNhatTieu = match ? match[1] : 'khÃ´ng rÃµ';

    // ğŸ‘â€ğŸ—¨ Hiá»ƒn thá»‹ ngÃ y cáº­p nháº­t phÃ­a trÃªn báº£ng
    const ngayTongHop = `â˜• GiÃ¡ cÃ  phÃª ngÃ y ${ngayCapNhatCaPhe} â€“ ğŸŒ¿ GiÃ¡ tiÃªu ngÃ y ${ngayCapNhatTieu}`;
    document.getElementById('ngayTongHop').textContent = ngayTongHop;

    let nongSanHTML = `
      <table class="mt-1">
        <tr><th>Sáº£n pháº©m</th><th>Khu vá»±c</th><th>GiÃ¡</th><th>Thay Ä‘á»•i</th></tr>`;

    // ğŸ‘‰ CÃ  phÃª
    const cp = data.caphe;
    nongSanHTML += `
      <tr>
        <td>CÃ  phÃª</td>
        <td>Äáº¯k NÃ´ng</td>
        <td>${cp.gia.toLocaleString('vi-VN')}</td>
        <td>
          <span class="${cp.thaydoi > 0 ? 'positive' : cp.thaydoi < 0 ? 'negative' : ''}">
            ${cp.thaydoi > 0 ? `+ ${cp.thaydoi.toLocaleString('vi-VN')}` :
              cp.thaydoi < 0 ? `- ${Math.abs(cp.thaydoi).toLocaleString('vi-VN')}` : `KhÃ´ng Ä‘á»•i`}
          </span>
        </td>
      </tr>`;

    // ğŸ‘‰ TiÃªu
    const tieu = data.tieu;
    tieu.data.forEach(item => {
      let changeClass = item.thayDoi > 0 ? 'positive' : item.thayDoi < 0 ? 'negative' : '';
      let changeText = item.thayDoi > 0 ? `+ ${item.thayDoi.toLocaleString('vi-VN')}` :
                       item.thayDoi < 0 ? `- ${Math.abs(item.thayDoi).toLocaleString('vi-VN')}` : `KhÃ´ng Ä‘á»•i`;
      nongSanHTML += `
        <tr>
          <td>TiÃªu</td>
          <td>${item.khuVuc}</td>
          <td>${item.giaMua.toLocaleString('vi-VN')}</td>
          <td><span class="${changeClass}">${changeText}</span></td>
        </tr>`;
    });

    nongSanHTML += `</table>`;
    document.getElementById('giaNongSan').innerHTML = nongSanHTML;

  } catch (error) {
    document.getElementById('giaNongSan').innerHTML = "ğŸš« KhÃ´ng láº¥y Ä‘Æ°á»£c giÃ¡.";
    console.error('Lá»—i:', error);
  }
}

    loadGia();
    setInterval(loadGia, 300000);

    function updateClock() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      const timeString = `${hours}:${minutes}:${seconds}`;
      document.getElementById('clock').textContent = timeString;
      
      const weekdays = ['Chá»§ Nháº­t', 'Thá»© Hai', 'Thá»© Ba', 'Thá»© TÆ°', 'Thá»© NÄƒm', 'Thá»© SÃ¡u', 'Thá»© Báº£y'];
      document.getElementById('thu').textContent = weekdays[now.getDay()];
      
      const today = `${String(now.getDate()).padStart(2, '0')}-${String(now.getMonth() + 1).padStart(2, '0')}`;
      loadNgayLe(today);
    }

    setInterval(updateClock, 1000);
    updateClock();

    function getLichAmDuong() {
      const url = 'https://script.google.com/macros/s/AKfycbzk1k3wh6KS0B3yDJzZm07HTYgmkP6sGd0HzhAjN5Kh3bGlFJgRRa93aFHzdNCOP1fz/exec';

      fetch(url)
        .then(response => response.json())
        .then(data => {
          document.getElementById('ngayDuong').textContent = data.ngayDuong || 'KhÃ´ng rÃµ';
          document.getElementById('ngayAmLich').textContent = data.ngayAmLich || 'KhÃ´ng rÃµ';
          document.getElementById('ngayDacBiet').textContent = data.ngayDacBiet || 'KhÃ´ng rÃµ';
        })
        .catch(error => {
          document.getElementById('ngayDuong').textContent = 'Lá»—i';
          document.getElementById('ngayAmLich').textContent = 'Lá»—i';
          document.getElementById('ngayDacBiet').textContent = 'Lá»—i';
          console.error('Lá»—i láº¥y lá»‹ch:', error);
        });
    }

    function loadNgayLe(today) {
      fetch('le.json')
        .then(response => response.json())
        .then(data => {
          const ngayLe = data.find(item => item.ngay === today && item.loai === 'duong');
          document.getElementById('tenNgayLe').textContent = ngayLe ? ngayLe.ten : 'KhÃ´ng cÃ³ ngÃ y lá»…';
        })
        .catch(error => {
          document.getElementById('tenNgayLe').textContent = 'Lá»—i táº£i ngÃ y lá»…';
          console.error('Lá»—i táº£i le.json:', error);
        });
    }

    getLichAmDuong();
  </script>
</body>
</html>
